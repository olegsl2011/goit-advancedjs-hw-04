{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst pixabayApi = axios.create({\n  baseURL: 'https://pixabay.com/api',\n});\n\nconst PER_PAGE = 15;\n\nexport const fetchImages = async ({ query, page = 1 }) => {\n  try {\n    const response = await pixabayApi.get('/', {\n      params: {\n        key: '18172942-eab38dca32c93699ea5d62826',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: PER_PAGE,\n        page,\n      },\n    });\n\n    const { hits, totalHits } = response.data;\n    return {\n      images: hits.map(\n        ({\n          comments,\n          downloads,\n          likes,\n          views,\n          largeImageURL,\n          webformatURL,\n          tags,\n        }) => ({\n          comments,\n          downloads,\n          likes,\n          views,\n          largeImageURL,\n          webformatURL,\n          tags,\n        })\n      ),\n      pages: Math.round(totalHits / PER_PAGE),\n    };\n  } catch (e) {\n    console.log(e);\n  }\n};\n","const getStatisticsItemMarkup = (name, count) => `\n        <li class=\"image-statistics-list-item\">\n            <h3>${name}</h3>\n            <p>${count}</p>\n          </li>\n        `;\n\nexport const createGalleryMarkup = images => {\n  return images\n    .map(\n      ({\n        comments,\n        downloads,\n        likes,\n        views,\n        largeImageURL,\n        webformatURL,\n        tags,\n      }) => `\n     <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <ul class=\"image-statistics-list\">\n            ${getStatisticsItemMarkup('Likes', likes)}\n            ${getStatisticsItemMarkup('Views', views)}\n            ${getStatisticsItemMarkup('Comments', comments)}\n            ${getStatisticsItemMarkup('Downloads', downloads)}\n        </ul>\n      </li>\n    `\n    )\n    .join('');\n};\n\nexport const renderMarkup = ({ ref, position = 'beforeEnd', markup }) => {\n  ref.insertAdjacentHTML(position, markup);\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderMarkup, createGalleryMarkup } from './js/render-functions.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const refs = {\n    form: document.querySelector('.search-form'),\n    gallery: document.querySelector('.gallery'),\n    spinner: document.querySelector('.spinner'),\n    loadMore: document.querySelector('.load-more-button'),\n  };\n\n  let currentPage = 1;\n  let query = '';\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  const toggleLoading = isLoading => {\n    refs.spinner.classList.toggle('loading', isLoading);\n  };\n\n  const toggleLoadMore = isVisible => {\n    refs.loadMore.classList.toggle('active', isVisible);\n  };\n\n  const showError = (\n    message = 'Sorry, there are no images matching your search query. Please try again!'\n  ) => {\n    iziToast.error({\n      message,\n      position: 'topRight',\n    });\n  };\n\n  const renderImages = images => {\n    renderMarkup({\n      ref: refs.gallery,\n      markup: createGalleryMarkup(images),\n    });\n    lightbox.refresh();\n  };\n\n  const fetchAndRenderImages = async (isLoadMore = false) => {\n    try {\n      const { images, pages } = await fetchImages({ query, page: currentPage });\n      if (images.length) {\n        renderImages(images);\n        toggleLoadMore(pages > currentPage);\n\n        if (isLoadMore && pages <= currentPage) {\n          iziToast.info({\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n          });\n        }\n      } else {\n        showError();\n      }\n    } catch (error) {\n      showError(\n        'An error occurred while fetching the images. Please try again later.'\n      );\n    } finally {\n      toggleLoading(false);\n    }\n  };\n\n  const onSubmit = async e => {\n    e.preventDefault();\n    query = refs.form.query.value.trim();\n\n    if (!query) {\n      showError('Please enter a valid search query.');\n      return;\n    }\n\n    refs.gallery.innerHTML = '';\n    currentPage = 1;\n    toggleLoading(true);\n    toggleLoadMore(false);\n\n    await fetchAndRenderImages();\n  };\n\n  const onLoadMore = async () => {\n    currentPage++;\n    toggleLoading(true);\n    toggleLoadMore(false);\n\n    await fetchAndRenderImages(true);\n\n    const galleryItem = document.querySelector('.gallery li');\n    if (galleryItem) {\n      const scrollHeight = galleryItem.getBoundingClientRect().height * 2;\n      window.scrollBy(0, scrollHeight);\n    }\n  };\n\n  refs.form.addEventListener('submit', onSubmit);\n  refs.loadMore.addEventListener('click', onLoadMore);\n});\n"],"names":["pixabayApi","axios","PER_PAGE","fetchImages","query","page","response","hits","totalHits","comments","downloads","likes","views","largeImageURL","webformatURL","tags","e","getStatisticsItemMarkup","name","count","createGalleryMarkup","images","renderMarkup","ref","position","markup","refs","currentPage","lightbox","SimpleLightbox","toggleLoading","isLoading","toggleLoadMore","isVisible","showError","message","iziToast","renderImages","fetchAndRenderImages","isLoadMore","pages","onSubmit","onLoadMore","galleryItem","scrollHeight"],"mappings":"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"}